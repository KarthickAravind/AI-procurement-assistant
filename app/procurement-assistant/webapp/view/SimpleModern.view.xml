<mvc:View
    controllerName="procurement.assistant.controller.SimpleModern"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:core="sap.ui.core"
    xmlns:table="sap.ui.table"
    displayBlock="true">
    
    <f:DynamicPage id="simpleDynamicPage" headerExpanded="true" showFooter="false">
        
        <!-- Dynamic Page Title -->
        <f:title>
            <f:DynamicPageTitle id="pageTitle">
                <f:heading>
                    <Title id="mainTitle" text="AI-Powered Procurement Assistant" level="H1"/>
                </f:heading>
                <f:actions>
                    <Button id="settingsBtn" text="Settings" icon="sap-icon://action-settings" press="onOpenSettings"/>
                    <Button id="helpBtn" text="Help" icon="sap-icon://sys-help" press="onOpenHelp"/>
                </f:actions>
            </f:DynamicPageTitle>
        </f:title>
        
        <!-- Dynamic Page Header with KPI Cards -->
        <f:header>
            <f:DynamicPageHeader id="pageHeader" pinnable="true">
                <f:content>
                    <HBox wrap="Wrap" class="sapUiMediumMargin">
                        
                        <!-- KPI Cards Row using Tiles -->
                        <VBox class="sapUiMediumMarginEnd">
                            <GenericTile id="materialsTile" class="sapUiMediumMarginBottom" 
                                        header="Total Materials" subheader="Inventory Overview"
                                        frameType="OneByOne" press="onMaterialsTilePress">
                                <tileContent>
                                    <TileContent id="materialsContent">
                                        <content>
                                            <NumericContent id="materialsNumeric" 
                                                          value="{/materialsCount}" 
                                                          indicator="Up" 
                                                          size="M"
                                                          valueColor="Good"/>
                                        </content>
                                    </TileContent>
                                </tileContent>
                            </GenericTile>
                        </VBox>
                        
                        <VBox class="sapUiMediumMarginEnd">
                            <GenericTile id="suppliersTile" class="sapUiMediumMarginBottom" 
                                        header="Active Suppliers" subheader="Network Status"
                                        frameType="OneByOne" press="onSuppliersTilePress">
                                <tileContent>
                                    <TileContent id="suppliersContent">
                                        <content>
                                            <NumericContent id="suppliersNumeric" 
                                                          value="{/suppliersCount}" 
                                                          indicator="Up" 
                                                          size="M"
                                                          valueColor="Good"/>
                                        </content>
                                    </TileContent>
                                </tileContent>
                            </GenericTile>
                        </VBox>
                        
                        <VBox class="sapUiMediumMarginEnd">
                            <GenericTile id="aiTile" class="sapUiMediumMarginBottom" 
                                        header="AI Insights" subheader="Smart Recommendations"
                                        frameType="OneByOne" press="onAITilePress">
                                <tileContent>
                                    <TileContent id="aiContent">
                                        <content>
                                            <NumericContent id="aiNumeric" 
                                                          value="{/aiInsightsCount}" 
                                                          indicator="Up" 
                                                          size="M"
                                                          valueColor="Good"/>
                                        </content>
                                    </TileContent>
                                </tileContent>
                            </GenericTile>
                        </VBox>
                        
                    </HBox>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>
        
        <!-- Main Content with Flexible Column Layout -->
        <f:content>
            <f:FlexibleColumnLayout id="simpleFcl" layout="TwoColumnsBeginExpanded" 
                                   backgroundDesign="Solid" class="sapUiContentPadding">
                
                <!-- Begin Column - AI Chat Assistant -->
                <f:beginColumnPages>
                    <Page id="chatPage" title="AI Assistant" showNavButton="false" 
                          class="sapUiResponsiveContentPadding">
                        
                        <content>
                            <VBox height="100%" class="sapUiMediumMargin">
                                
                                <!-- Quick Action Buttons -->
                                <Panel id="quickActionsPanel" headerText="Quick Actions" expandable="false" 
                                       class="sapUiMediumMarginBottom">
                                    <content>
                                        <HBox wrap="Wrap" class="sapUiSmallMargin">
                                            <Button id="createPOBtn" text="Create PO" icon="sap-icon://create-form" 
                                                   type="Emphasized" class="sapUiTinyMarginEnd sapUiTinyMarginBottom"
                                                   press="onQuickActionCreatePO"/>
                                            <Button id="sendRFQBtn" text="Send RFQ" icon="sap-icon://email" 
                                                   type="Emphasized" class="sapUiTinyMarginEnd sapUiTinyMarginBottom"
                                                   press="onQuickActionSendRFQ"/>
                                            <Button id="findSuppliersBtn" text="Find Suppliers" icon="sap-icon://supplier" 
                                                   type="Default" class="sapUiTinyMarginEnd sapUiTinyMarginBottom"
                                                   press="onQuickActionFindSuppliers"/>
                                            <Button id="checkInventoryBtn" text="Check Inventory" icon="sap-icon://inventory" 
                                                   type="Default" class="sapUiTinyMarginEnd sapUiTinyMarginBottom"
                                                   press="onQuickActionCheckInventory"/>
                                        </HBox>
                                    </content>
                                </Panel>
                                
                                <!-- Chat Interface -->
                                <Panel id="chatPanel" headerText="AI Chat" expandable="false" height="500px">
                                    <content>
                                        <VBox height="100%">
                                            
                                            <!-- Chat Messages Container -->
                                            <ScrollContainer id="simpleChatScrollContainer" 
                                                           height="400px" vertical="true" 
                                                           class="sapUiMediumMarginBottom">
                                                <content>
                                                    <VBox id="simpleChatMessagesContainer" class="sapUiSmallMargin">
                                                        <!-- Welcome Messages -->
                                                        <MessageStrip id="welcomeMsg1" 
                                                                     text="ðŸ‘‹ Hello! I'm your AI procurement assistant. I can help you with suppliers, materials, pricing, and procurement processes." 
                                                                     type="Information" class="sapUiMediumMarginBottom"/>
                                                        <MessageStrip id="welcomeMsg2" 
                                                                     text="ðŸ’¡ Try the quick action buttons above or ask me anything!" 
                                                                     type="Success" class="sapUiMediumMarginBottom"/>
                                                    </VBox>
                                                </content>
                                            </ScrollContainer>
                                            
                                            <!-- Chat Input -->
                                            <VBox>
                                                <HBox width="100%" alignItems="End">
                                                    <TextArea id="simpleChatInput" 
                                                             placeholder="Type your message here... (e.g., 'Find laptops under â‚¹50K')"
                                                             maxLength="1000" 
                                                             growing="true"
                                                             growingMaxLines="5"
                                                             class="sapUiMediumMarginEnd"
                                                             width="100%"/>
                                                    <Button id="sendChatBtn" text="Send" type="Emphasized" 
                                                           icon="sap-icon://paper-plane" 
                                                           press="onSendChatMessage"/>
                                                </HBox>
                                            </VBox>
                                            
                                        </VBox>
                                    </content>
                                </Panel>
                                
                            </VBox>
                        </content>
                        
                    </Page>
                </f:beginColumnPages>
                
                <!-- Mid Column - Warehouse Management -->
                <f:midColumnPages>
                    <Page id="warehousePage" title="Warehouse Management" showNavButton="false" 
                          class="sapUiResponsiveContentPadding">
                        
                        <content>
                            <VBox height="100%" class="sapUiMediumMargin">
                                
                                <!-- Search and Filters -->
                                <Panel id="filtersPanel" headerText="Filters & Search" expandable="true" expanded="false" 
                                       class="sapUiMediumMarginBottom">
                                    <content>
                                        <VBox class="sapUiSmallMargin">
                                            <SearchField id="simpleMaterialSearchField" 
                                                       placeholder="Search materials by name, ID, or supplier..." 
                                                       width="100%" search="onSearchMaterials" 
                                                       class="sapUiMediumMarginBottom"/>
                                            <HBox wrap="Wrap">
                                                <ComboBox id="simpleCategoryFilter" placeholder="Filter by Category" 
                                                         class="sapUiTinyMarginEnd" selectionChange="onFilterChange">
                                                    <core:Item key="" text="All Categories"/>
                                                    <core:Item key="Construction" text="Construction"/>
                                                    <core:Item key="Manufacturing" text="Manufacturing"/>
                                                    <core:Item key="Logistics" text="Logistics"/>
                                                </ComboBox>
                                                <ComboBox id="simpleStatusFilter" placeholder="Filter by Status" 
                                                         class="sapUiTinyMarginEnd" selectionChange="onFilterChange">
                                                    <core:Item key="" text="All Status"/>
                                                    <core:Item key="Normal" text="Normal Stock"/>
                                                    <core:Item key="Low Stock" text="Low Stock"/>
                                                    <core:Item key="Overstock" text="Overstock"/>
                                                </ComboBox>
                                            </HBox>
                                        </VBox>
                                    </content>
                                </Panel>
                                
                                <!-- Materials Table -->
                                <Panel id="materialsPanel" headerText="Materials Inventory" class="sapUiMediumMarginBottom">
                                    <headerToolbar>
                                        <Toolbar id="materialsToolbar">
                                            <Title id="materialsTitle" text="Warehouse Supplies" level="H4"/>
                                            <ToolbarSpacer id="toolbarSpacer"/>
                                            <Button id="addMaterialBtn" text="Add Material" type="Emphasized" 
                                                   icon="sap-icon://add" press="onAddMaterial"/>
                                            <Button id="importCSVBtn" text="Import CSV" icon="sap-icon://download" 
                                                   press="onImportCSV"/>
                                            <Button id="exportBtn" text="Export" icon="sap-icon://upload" 
                                                   press="onExportMaterials"/>
                                            <Button id="refreshBtn" text="Refresh" icon="sap-icon://refresh" 
                                                   press="onRefreshMaterials"/>
                                            <Text id="simpleMaterialsCountText" text="Loading..." 
                                                 class="sapUiMediumMarginBegin"/>
                                        </Toolbar>
                                    </headerToolbar>
                                    <content>
                                        <Table id="simpleMaterialsTable" 
                                               items="{/materials}" 
                                               mode="SingleSelect"
                                               class="sapUiMediumMarginTop">
                                            
                                            <columns>
                                                <Column id="idColumn">
                                                    <Text text="Material ID"/>
                                                </Column>
                                                <Column id="nameColumn">
                                                    <Text text="Name"/>
                                                </Column>
                                                <Column id="supplierColumn">
                                                    <Text text="Supplier"/>
                                                </Column>
                                                <Column id="quantityColumn">
                                                    <Text text="Quantity"/>
                                                </Column>
                                                <Column id="categoryColumn">
                                                    <Text text="Category"/>
                                                </Column>
                                                <Column id="statusColumn">
                                                    <Text text="Status"/>
                                                </Column>
                                                <Column id="actionsColumn">
                                                    <Text text="Actions"/>
                                                </Column>
                                            </columns>
                                            
                                            <items>
                                                <ColumnListItem id="materialItem" press="onMaterialSelect">
                                                    <cells>
                                                        <Text text="{ID}"/>
                                                        <Text text="{name}"/>
                                                        <Text text="{supplier_ID}"/>
                                                        <Text text="{quantity} {unit}"/>
                                                        <Text text="{category}"/>
                                                        <ObjectStatus text="{stockStatus}" 
                                                                     state="{path: 'stockStatus', formatter: '.formatStockStatus'}"/>
                                                        <HBox>
                                                            <Button icon="sap-icon://edit" type="Transparent" 
                                                                   tooltip="Edit Material" press="onEditMaterial"/>
                                                            <Button icon="sap-icon://delete" type="Transparent" 
                                                                   tooltip="Delete Material" press="onDeleteMaterial"/>
                                                        </HBox>
                                                    </cells>
                                                </ColumnListItem>
                                            </items>
                                        </Table>
                                    </content>
                                </Panel>
                                
                            </VBox>
                        </content>
                        
                    </Page>
                </f:midColumnPages>
                
            </f:FlexibleColumnLayout>
        </f:content>
        
    </f:DynamicPage>
    
</mvc:View>
